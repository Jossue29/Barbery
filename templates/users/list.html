{% extends "base.html" %}
{% block content %}

<div class="container-fluid">
  <div class="row">

    <!-- ===== FORMULARIO ===== -->
    <div class="col-md-4">
      <div class="card">
        <div class="card-header">
          <strong>{{ title }}</strong>
        </div>
        <div class="card-body">
          <form method="post">
            {% csrf_token %}
            {{ form.as_p }}

            <button type="submit" class="btn btn-primary w-100">
              Guardar
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- ===== TABLA ===== -->
    <div class="col-md-8">
      <div class="card">
        <div class="card-header d-flex justify-content-between">
          <strong>Usuarios</strong>
          <a href="{% url 'users' %}" class="btn btn-sm btn-success">
            ➕ Nuevo
          </a>
        </div>

        <div class="card-body p-0">
          <table class="table table-striped table-hover mb-0">
            <thead class="table-dark">
              <tr>
                <th>Usuario</th>
                <th>Nombre</th>
                <th>Rol</th>
                <th>Teléfono</th>
                <th class="text-end">Acciones</th>
              </tr>
            </thead>
            <tbody>
              {% for u in users %}
              <tr>
                <td>{{ u.username }}</td>
                <td>{{ u.nombre }} {{ u.apellido }}</td>
                <td>
                  <span class="badge bg-secondary">{{ u.rol }}</span>
                </td>
                <td>{{ u.telefono }}</td>
                <td class="text-end">
                  <a href="{% url 'users_edit' u.id %}"
                     class="btn btn-sm btn-warning">
                    ✏️
                  </a>
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="5" class="text-center text-muted">
                  No hay usuarios registrados
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- ===== PAGINADO ===== -->
        <div class="card-footer">
          <nav>
            <ul class="pagination justify-content-center mb-0">
              {% if users.has_previous %}
              <li class="page-item">
                <a class="page-link" href="?page={{ users.previous_page_number }}">
                  ←
                </a>
              </li>
              {% endif %}

              <li class="page-item disabled">
                <span class="page-link">
                  Página {{ users.number }} de {{ users.paginator.num_pages }}
                </span>
              </li>

              {% if users.has_next %}
              <li class="page-item">
                <a class="page-link" href="?page={{ users.next_page_number }}">
                  →
                </a>
              </li>
              {% endif %}
            </ul>
          </nav>
        </div>

      </div>
    </div>

  </div>
</div>

{% endblock %}
